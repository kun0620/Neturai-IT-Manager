import{r as u}from"./vendor-react-CqgMBxNQ.js";import{s as a}from"./index-DFoI8Gyt.js";const p=()=>{const[t,l]=u.useState(null),[s,r]=u.useState(null),[i,c]=u.useState(!0);return u.useEffect(()=>{const n=async o=>{const{data:e,error:f}=await a.from("profiles").select("role").eq("id",o).single();if(!f&&(e!=null&&e.role)&&(e.role==="admin"||e.role==="it"||e.role==="user")){r(e.role);return}r(null)};(async()=>{const{data:o}=await a.auth.getSession(),e=o.session;l(e),e!=null&&e.user?await n(e.user.id):r(null),c(!1)})();const{data:{subscription:d}}=a.auth.onAuthStateChange((o,e)=>{if(l(e),!(e!=null&&e.user)){r(null);return}n(e.user.id)});return()=>d.unsubscribe()},[]),{session:t,user:(t==null?void 0:t.user)??null,role:s,loading:i}};export{p as u};
