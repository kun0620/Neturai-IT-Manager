import{r as n,j as e}from"./vendor-react-BzKcyMZF.js";import{d as X,f as b,g as ee,e as ae,h as te,i as se}from"./vendor-tanstack-CEPwOq2U.js";import{I as y,K as C,M as v,B as m,N as D,O as le,W as oe,Y as ne,Z as R,$ as ie,b as r,s as re,H as A}from"./index-W22mHG5Q.js";import{T as de,a as ce,b as p,c as me,d as ue,e as M}from"./useCurrentProfile-moe49XOh.js";import{a2 as ge,a3 as xe,a4 as F,a5 as T,a6 as V,a7 as P,a8 as E,a9 as k}from"./vendor-radix-I-8VOjah.js";const S="datatable-density";function Se({columns:s,data:l,filterColumnId:a,filterPlaceholder:H,globalFilterPlaceholder:I,onRowClick:u,showGlobalFilter:_=!0,enableRowSelection:g=!1,getRowId:B,onSelectedRowsChange:x,clearSelectionKey:c}){var j,N;const[G,$]=n.useState([]),[L,O]=n.useState([]),[Y,W]=n.useState({}),[h,Z]=n.useState({}),w=n.useRef(void 0),[q,J]=n.useState(""),[d,K]=n.useState(()=>typeof window>"u"?"comfortable":window.localStorage.getItem(S)==="compact"?"compact":"comfortable");n.useEffect(()=>{window.localStorage.setItem(S,d)},[d]);const Q=d==="compact"?"h-8 px-2 text-xs":"h-10 px-3",U=d==="compact"?"px-2 py-1.5":"px-3 py-2.5",o=X({data:l,columns:s,onSortingChange:$,onColumnFiltersChange:O,onGlobalFilterChange:J,getCoreRowModel:se(),getPaginationRowModel:te(),getSortedRowModel:ae(),getFilteredRowModel:ee(),onColumnVisibilityChange:W,onRowSelectionChange:Z,enableRowSelection:g,getRowId:B,state:{sorting:G,columnFilters:L,globalFilter:q,columnVisibility:Y,rowSelection:h}});return n.useEffect(()=>{x&&x(o.getSelectedRowModel().rows.map(t=>t.original))},[x,h,o,l]),n.useEffect(()=>{c!==void 0&&w.current!==c&&(w.current=c,o.resetRowSelection())},[c,o]),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2",children:[_&&e.jsx(y,{placeholder:I||"Search all columns...",value:o.getState().globalFilter??"",onChange:t=>o.setGlobalFilter(t.target.value),className:"h-8 w-full max-w-sm text-sm"}),a&&e.jsx(y,{placeholder:H||`Filter ${a}...`,value:((j=o.getColumn(a))==null?void 0:j.getFilterValue())??"",onChange:t=>{var i;return(i=o.getColumn(a))==null?void 0:i.setFilterValue(t.target.value)},className:"h-8 w-full max-w-sm text-sm"}),e.jsxs(C,{children:[e.jsx(v,{asChild:!0,children:e.jsx(m,{variant:"outline",className:"ml-auto h-8 text-sm",children:"Density"})}),e.jsxs(D,{align:"end",children:[e.jsx(le,{children:"Table density"}),e.jsx(oe,{}),e.jsxs(ne,{value:d,onValueChange:t=>K(t),children:[e.jsx(R,{value:"comfortable",children:"Comfortable"}),e.jsx(R,{value:"compact",children:"Compact"})]})]})]}),e.jsxs(C,{children:[e.jsx(v,{asChild:!0,children:e.jsx(m,{variant:"outline",className:"ml-2 h-8 text-sm",children:"Columns"})}),e.jsx(D,{align:"end",children:o.getAllColumns().filter(t=>t.getCanHide()).map(t=>e.jsx(ie,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:i=>t.toggleVisibility(!!i),children:t.id},t.id))})]})]}),e.jsx("div",{className:"rounded-md border bg-background text-foreground",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(de,{children:[e.jsx(ce,{children:o.getHeaderGroups().map(t=>e.jsx(p,{children:t.headers.map(i=>{const f=i.column.columnDef.meta??{};return e.jsx(me,{className:r(Q,f.headerClassName),children:i.isPlaceholder?null:b(i.column.columnDef.header,i.getContext())},i.id)})},t.id))}),e.jsx(ue,{children:(N=o.getRowModel().rows)!=null&&N.length?o.getRowModel().rows.map(t=>e.jsx(p,{"data-state":t.getIsSelected()&&"selected",onClick:()=>{if(u){u(t.original);return}g&&t.toggleSelected()},className:u||g?"cursor-pointer hover:bg-muted/50":"",children:t.getVisibleCells().map(i=>{const f=i.column.columnDef.meta??{};return e.jsx(M,{className:r(U,f.cellClassName),children:b(i.column.columnDef.cell,i.getContext())},i.id)})},t.id)):e.jsx(p,{children:e.jsx(M,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx("div",{className:"flex-1 text-sm text-muted-foreground",children:o.getFilteredSelectedRowModel().rows.length>0?`${o.getFilteredSelectedRowModel().rows.length} of ${o.getFilteredRowModel().rows.length} row(s) selected.`:""}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>o.previousPage(),disabled:!o.getCanPreviousPage(),children:"Previous"}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>o.nextPage(),disabled:!o.getCanNextPage(),children:"Next"})]})]})]})}async function Ae(s){if(!s.length)return;const{error:l}=await re.from("asset_logs").insert(s.map(a=>({asset_id:a.assetId,action:a.action,field:a.field,old_value:a.oldValue,new_value:a.newValue,performed_by:a.performedBy??null,metadata:a.metadata??null})))}const Fe=ge,fe=xe,z=n.forwardRef(({className:s,...l},a)=>e.jsx(k,{className:r("fixed inset-0 z-50 bg-background/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:a}));z.displayName=k.displayName;const pe=n.forwardRef(({className:s,...l},a)=>e.jsxs(fe,{children:[e.jsx(z,{}),e.jsx(F,{ref:a,className:r("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",s),...l})]}));pe.displayName=F.displayName;const he=({className:s,...l})=>e.jsx("div",{className:r("flex flex-col space-y-2 text-center sm:text-left",s),...l});he.displayName="AlertDialogHeader";const we=({className:s,...l})=>e.jsx("div",{className:r("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...l});we.displayName="AlertDialogFooter";const je=n.forwardRef(({className:s,...l},a)=>e.jsx(T,{ref:a,className:r("text-lg font-semibold",s),...l}));je.displayName=T.displayName;const Ne=n.forwardRef(({className:s,...l},a)=>e.jsx(V,{ref:a,className:r("text-sm text-muted-foreground",s),...l}));Ne.displayName=V.displayName;const be=n.forwardRef(({className:s,...l},a)=>e.jsx(E,{ref:a,className:r(A(),s),...l}));be.displayName=E.displayName;const ye=n.forwardRef(({className:s,...l},a)=>e.jsx(P,{ref:a,className:r(A({variant:"outline"}),"mt-2 sm:mt-0",s),...l}));ye.displayName=P.displayName;export{Fe as A,Se as D,pe as a,he as b,je as c,Ne as d,we as e,ye as f,be as g,Ae as i};
