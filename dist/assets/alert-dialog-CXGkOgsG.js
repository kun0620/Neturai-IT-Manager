import{r as l,j as e}from"./vendor-react-CqgMBxNQ.js";import{d as me,f as C,g as fe,e as ue,h as pe,i as xe}from"./vendor-tanstack-DVpCzg3k.js";import{b as n,B as u,s as ge,j as A}from"./index-DFoI8Gyt.js";import{$ as be,G as he,J as Ne,K as we,M as T,N as z,Q as V,U as I,W as P,X as k,Y as je,Z as E,z as ye,a0 as _,C as ve,a1 as H,a2 as $e,a3 as Ce,a4 as B,a5 as G,a6 as L,a7 as Y,a8 as O,a9 as J}from"./vendor-radix-DW-K601O.js";import{I as D}from"./input-CmXEoJvQ.js";import{T as De,a as Re,b as h,c as Me,d as Se,e as R}from"./useCurrentProfile-CRnoZ3gy.js";const M=be,S=he,Fe=Ne,Ae=l.forwardRef(({className:t,inset:s,children:a,...i},c)=>e.jsxs(_,{ref:c,className:n("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",t),...i,children:[a,e.jsx(ve,{className:"ml-auto h-4 w-4"})]}));Ae.displayName=_.displayName;const Te=l.forwardRef(({className:t,...s},a)=>e.jsx(H,{ref:a,className:n("z-[9999] min-w-[8rem] overflow-hidden rounded-md border bg-card p-1 text-foreground shadow-xl data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Te.displayName=H.displayName;const N=l.forwardRef(({className:t,sideOffset:s=6,...a},i)=>e.jsx(we,{children:e.jsx(T,{ref:i,sideOffset:s,className:n("z-[9999] min-w-[8rem] overflow-hidden rounded-md border bg-card p-1 text-foreground shadow-xl","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));N.displayName=T.displayName;const ze=l.forwardRef(({className:t,inset:s,...a},i)=>e.jsx(V,{ref:i,className:n("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...a}));ze.displayName=V.displayName;const Q=l.forwardRef(({className:t,children:s,checked:a,...i},c)=>e.jsxs(E,{ref:c,className:n("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:a,...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(k,{children:e.jsx(ye,{className:"h-4 w-4"})})}),s]}));Q.displayName=E.displayName;const w=l.forwardRef(({className:t,children:s,...a},i)=>e.jsxs(P,{ref:i,className:n("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(k,{children:e.jsx(je,{className:"h-4 w-4 fill-current"})})}),s]}));w.displayName=P.displayName;const U=l.forwardRef(({className:t,inset:s,...a},i)=>e.jsx(z,{ref:i,className:n("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...a}));U.displayName=z.displayName;const W=l.forwardRef(({className:t,...s},a)=>e.jsx(I,{ref:a,className:n("-mx-1 my-1 h-px bg-muted",t),...s}));W.displayName=I.displayName;const F="datatable-density";function Ue({columns:t,data:s,filterColumnId:a,filterPlaceholder:i,globalFilterPlaceholder:c,onRowClick:p,showGlobalFilter:Z=!0,enableRowSelection:x=!1,getRowId:q,onSelectedRowsChange:g,clearSelectionKey:f}){var v,$;const[K,ee]=l.useState([]),[ae,te]=l.useState([]),[se,oe]=l.useState({}),[j,le]=l.useState({}),y=l.useRef(void 0),[de,ne]=l.useState(""),[m,re]=l.useState(()=>typeof window>"u"?"comfortable":window.localStorage.getItem(F)==="compact"?"compact":"comfortable");l.useEffect(()=>{window.localStorage.setItem(F,m)},[m]);const ie=m==="compact"?"h-8 px-2 text-xs":"h-10 px-3",ce=m==="compact"?"px-2 py-1.5":"px-3 py-2.5",d=me({data:s,columns:t,onSortingChange:ee,onColumnFiltersChange:te,onGlobalFilterChange:ne,getCoreRowModel:xe(),getPaginationRowModel:pe(),getSortedRowModel:ue(),getFilteredRowModel:fe(),onColumnVisibilityChange:oe,onRowSelectionChange:le,enableRowSelection:x,getRowId:q,state:{sorting:K,columnFilters:ae,globalFilter:de,columnVisibility:se,rowSelection:j}});return l.useEffect(()=>{g&&g(d.getSelectedRowModel().rows.map(o=>o.original))},[g,j,d,s]),l.useEffect(()=>{f!==void 0&&y.current!==f&&(y.current=f,d.resetRowSelection())},[f,d]),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2",children:[Z&&e.jsx(D,{placeholder:c||"Search all columns...",value:d.getState().globalFilter??"",onChange:o=>d.setGlobalFilter(o.target.value),className:"h-8 w-full max-w-sm text-sm"}),a&&e.jsx(D,{placeholder:i||`Filter ${a}...`,value:((v=d.getColumn(a))==null?void 0:v.getFilterValue())??"",onChange:o=>{var r;return(r=d.getColumn(a))==null?void 0:r.setFilterValue(o.target.value)},className:"h-8 w-full max-w-sm text-sm"}),e.jsxs(M,{children:[e.jsx(S,{asChild:!0,children:e.jsx(u,{variant:"outline",className:"ml-auto h-8 text-sm",children:"Density"})}),e.jsxs(N,{align:"end",children:[e.jsx(U,{children:"Table density"}),e.jsx(W,{}),e.jsxs(Fe,{value:m,onValueChange:o=>re(o),children:[e.jsx(w,{value:"comfortable",children:"Comfortable"}),e.jsx(w,{value:"compact",children:"Compact"})]})]})]}),e.jsxs(M,{children:[e.jsx(S,{asChild:!0,children:e.jsx(u,{variant:"outline",className:"ml-2 h-8 text-sm",children:"Columns"})}),e.jsx(N,{align:"end",children:d.getAllColumns().filter(o=>o.getCanHide()).map(o=>e.jsx(Q,{className:"capitalize",checked:o.getIsVisible(),onCheckedChange:r=>o.toggleVisibility(!!r),children:o.id},o.id))})]})]}),e.jsx("div",{className:"rounded-md border bg-background text-foreground",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Re,{children:d.getHeaderGroups().map(o=>e.jsx(h,{children:o.headers.map(r=>{const b=r.column.columnDef.meta??{};return e.jsx(Me,{className:n(ie,b.headerClassName),children:r.isPlaceholder?null:C(r.column.columnDef.header,r.getContext())},r.id)})},o.id))}),e.jsx(Se,{children:($=d.getRowModel().rows)!=null&&$.length?d.getRowModel().rows.map(o=>e.jsx(h,{"data-state":o.getIsSelected()&&"selected",onClick:()=>{if(p){p(o.original);return}x&&o.toggleSelected()},className:p||x?"cursor-pointer hover:bg-muted/50":"",children:o.getVisibleCells().map(r=>{const b=r.column.columnDef.meta??{};return e.jsx(R,{className:n(ce,b.cellClassName),children:C(r.column.columnDef.cell,r.getContext())},r.id)})},o.id)):e.jsx(h,{children:e.jsx(R,{colSpan:t.length,className:"h-24 text-center",children:"No results."})})})]})})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx("div",{className:"flex-1 text-sm text-muted-foreground",children:d.getFilteredSelectedRowModel().rows.length>0?`${d.getFilteredSelectedRowModel().rows.length} of ${d.getFilteredRowModel().rows.length} row(s) selected.`:""}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>d.previousPage(),disabled:!d.getCanPreviousPage(),children:"Previous"}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>d.nextPage(),disabled:!d.getCanNextPage(),children:"Next"})]})]})]})}async function We(t){if(!t.length)return;const{error:s}=await ge.from("asset_logs").insert(t.map(a=>({asset_id:a.assetId,action:a.action,field:a.field,old_value:a.oldValue,new_value:a.newValue,performed_by:a.performedBy??null,metadata:a.metadata??null})))}const Xe=$e,Ve=Ce,X=l.forwardRef(({className:t,...s},a)=>e.jsx(J,{className:n("fixed inset-0 z-50 bg-background/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));X.displayName=J.displayName;const Ie=l.forwardRef(({className:t,...s},a)=>e.jsxs(Ve,{children:[e.jsx(X,{}),e.jsx(B,{ref:a,className:n("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",t),...s})]}));Ie.displayName=B.displayName;const Pe=({className:t,...s})=>e.jsx("div",{className:n("flex flex-col space-y-2 text-center sm:text-left",t),...s});Pe.displayName="AlertDialogHeader";const ke=({className:t,...s})=>e.jsx("div",{className:n("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});ke.displayName="AlertDialogFooter";const Ee=l.forwardRef(({className:t,...s},a)=>e.jsx(G,{ref:a,className:n("text-lg font-semibold",t),...s}));Ee.displayName=G.displayName;const _e=l.forwardRef(({className:t,...s},a)=>e.jsx(L,{ref:a,className:n("text-sm text-muted-foreground",t),...s}));_e.displayName=L.displayName;const He=l.forwardRef(({className:t,...s},a)=>e.jsx(O,{ref:a,className:n(A(),t),...s}));He.displayName=O.displayName;const Be=l.forwardRef(({className:t,...s},a)=>e.jsx(Y,{ref:a,className:n(A({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));Be.displayName=Y.displayName;export{Xe as A,M as D,S as a,N as b,U as c,ze as d,Ue as e,Ie as f,Pe as g,Ee as h,We as i,_e as j,ke as k,Be as l,He as m};
