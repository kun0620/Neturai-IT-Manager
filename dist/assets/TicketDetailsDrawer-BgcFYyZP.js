import{r as _,j as o}from"./vendor-react-CQhyLJhi.js";import{u as K,b as Fe,c as We}from"./vendor-tanstack-CEdBqcEP.js";import{d as le,t as C,i as oe,j as ye,k as se,l as Je,o as Wt,p as At,b as A,s as O,I as Et,B as te,L as Rt,n as U,a as ae,q as Bt,r as z,f as L,v as Yt,w as Ae,x as Ht,y as qt,z as st,C as et,u as Ut,e as zt}from"./index-C_wQioo6.js";import{D as Kt,k as Vt,l as Qt,m as $t,n as Zt,S as pe,f as ge,g as xe,i as be,j as Z,o as Gt,u as Xt}from"./useCurrentProfile-Bk_xV3Os.js";import{L as ve}from"./label-jewdQlVz.js";import{C as Jt,o as en,R as tn,T as nn,P as rn,p as it,q as lt,V as an,r as on,s as dt,u as sn,v as ct}from"./vendor-radix-GaIC7jQ4.js";import{f as Ee,g as ie,U as ln,h as dn,P as cn,D as un,b as fn,c as mn,d as vn,e as hn}from"./drawer-CSXHei8r.js";import{b as S,s as Ce}from"./subDays-CxkVo8Mp.js";import{B as yn}from"./badge-07SJJ_S6.js";import{m as pn}from"./mapLogToText-BvzNOTVA.js";/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=le("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=le("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=le("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=le("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function E(e,t){const n=C(e);if(isNaN(t))return oe(e,NaN);if(!t)return n;const r=n.getDate(),a=oe(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const s=a.getDate();return r>=s?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}function Ie(e,t){const n=t*7;return S(e,n)}function Nn(e,t){return E(e,t*12)}function kn(e){let t;return e.forEach(function(n){const r=C(n);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function jn(e){let t;return e.forEach(n=>{const r=C(n);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function T(e,t){const n=ye(e),r=ye(t);return+n==+r}function Dn(e,t,n){const r=se(e,n),a=se(t,n),s=+r-Je(r),i=+a-Je(a);return Math.round((s-i)/Wt)}function P(e){const t=C(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Re(e,t){var l,d,u,c;const n=At(),r=(t==null?void 0:t.weekStartsOn)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((c=(u=n.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,a=C(e),s=a.getDay(),i=(s<r?-7:0)+6-(s-r);return a.setDate(a.getDate()+i),a.setHours(23,59,59,999),a}function ut(e){return Re(e,{weekStartsOn:1})}function Cn(e){const t=C(e),n=t.getFullYear(),r=t.getMonth(),a=oe(e,0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}function Mn(e){return Math.trunc(+C(e)/1e3)}function Sn(e){const t=C(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function Tn(e,t){return Dn(Sn(e),P(e),t)+1}function Le(e,t){const n=C(e),r=C(t);return n.getTime()>r.getTime()}function ft(e,t){const n=C(e),r=C(t);return+n<+r}function Be(e,t){const n=C(e),r=C(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function Pn(e,t){const n=C(e),r=C(t);return n.getFullYear()===r.getFullYear()}function Me(e,t){const n=C(e),r=n.getFullYear(),a=n.getDate(),s=oe(e,0);s.setFullYear(r,t,15),s.setHours(0,0,0,0);const i=Cn(s);return n.setMonth(t,Math.min(a,i)),n}function tt(e,t){const n=C(e);return isNaN(+n)?oe(e,NaN):(n.setFullYear(t),n)}const Ye=_.forwardRef(({className:e,...t},n)=>o.jsx("textarea",{className:A("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));Ye.displayName="Textarea";const On=e=>{const t=Array.from(new Set(e==null?void 0:e.map(n=>n.user_id).filter(Boolean)));return K({queryKey:["logAuthors",t.join(",")],enabled:t.length>0,queryFn:async()=>{const n={};return await Promise.all(t.map(async r=>{const{data:a}=await O.from("profiles").select("id, name, email").eq("id",r).maybeSingle();a&&(n[r]=a)})),n}})},In=(e={})=>K({queryKey:["dashboardMetrics",e.userId??null,!!e.onlyMy],queryFn:async()=>{const{data:t,error:n}=await O.rpc("get_dashboard_metrics",{p_user_id:e.userId??null,p_only_my:!!e.onlyMy});if(n)throw n;const r=t==null?void 0:t[0];if(!r)return{totalTickets:0,totalAssets:0,openTicketsCount:0,inProgressTicketsCount:0,closedTicketsCount:0,todayTicketsCount:0,overdueTicketsCount:0,avgResolutionHours:null,openTrendDelta:0,inProgressTrendDelta:0,closedTrendDelta:0,todayTrendDelta:0,overdueTrendDelta:0,recentTickets:[]};const s=(Array.isArray(r.recent_tickets)?r.recent_tickets:[]).map(i=>{if(!i||typeof i!="object")return null;const l=i,d=l.id,u=l.title;return typeof d!="string"||typeof u!="string"?null:{id:d,title:u,category_id:typeof l.category_id=="string"?l.category_id:null,priority:typeof l.priority=="string"?l.priority:"low",status:l.status==="open"||l.status==="in_progress"||l.status==="closed"?l.status:"open",created_at:typeof l.created_at=="string"?l.created_at:null}}).filter(i=>i!==null);return{totalTickets:Number(r.total_tickets??0),totalAssets:Number(r.total_assets??0),openTicketsCount:Number(r.open_tickets_count??0),inProgressTicketsCount:Number(r.in_progress_tickets_count??0),closedTicketsCount:Number(r.closed_tickets_count??0),todayTicketsCount:Number(r.today_tickets_count??0),overdueTicketsCount:Number(r.overdue_tickets_count??0),avgResolutionHours:r.avg_resolution_hours===null?null:Number(r.avg_resolution_hours),openTrendDelta:Number(r.open_trend_delta??0),inProgressTrendDelta:Number(r.in_progress_trend_delta??0),closedTrendDelta:Number(r.closed_trend_delta??0),todayTrendDelta:Number(r.today_trend_delta??0),overdueTrendDelta:Number(r.overdue_trend_delta??0),recentTickets:s}}}),Ln=()=>K({queryKey:["allTickets"],queryFn:async()=>{const{data:e,error:t}=await O.from("tickets").select("*").order("created_at",{ascending:!1});if(t)throw t;return e??[]}}),Fn=e=>K({queryKey:["ticket",e],queryFn:async()=>{const{data:t,error:n}=await O.from("tickets").select("*").eq("id",e).single();if(n)throw n;return t},enabled:!!e}),Wn=()=>K({queryKey:["ticketCategories"],queryFn:async()=>{const{data:e,error:t}=await O.from("ticket_categories").select("*").order("name");if(t)throw t;return e??[]}}),An=()=>{const e=Fe();return We({mutationFn:async t=>{const{data:n,error:r}=await O.from("tickets").insert({created_by:t.user_id,title:t.subject,description:t.description,category_id:t.category_id,priority:t.priority,status:t.status}).select().single();if(r)throw r;return await O.from("logs").insert({action:"ticket.created",user_id:t.user_id,details:{ticket_id:n.id,title:n.title,priority:n.priority}}),n},onSuccess:()=>{e.invalidateQueries({queryKey:["allTickets"]}),e.invalidateQueries({queryKey:["recentTickets"]}),e.invalidateQueries({queryKey:["dashboardMetrics"]})}})},En=()=>{const e=Fe();return We({mutationFn:async({id:t,updates:n,userId:r})=>{const{data:a,error:s}=await O.rpc("update_ticket_with_logs",{p_id:t,p_updates:n,p_user_id:r});if(s)throw s;return a},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["ticket",n.id]}),e.invalidateQueries({queryKey:["allTickets"]}),e.invalidateQueries({queryKey:["recentTickets"]}),e.invalidateQueries({queryKey:["dashboardMetrics"]})}})},Rn=e=>K({queryKey:["ticketComments",e],queryFn:async()=>{if(!e)return[];const{data:t,error:n}=await O.from("ticket_comments").select("*").eq("ticket_id",e).order("created_at",{ascending:!0});if(n)throw n;return t??[]},enabled:!!e}),Bn=()=>{const e=Fe();return We({mutationFn:async t=>{const{data:n,error:r}=await O.from("ticket_comments").insert(t).select().single();if(r)throw r;return n},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["ticketComments",n.ticket_id]})}})},Yn=e=>K({queryKey:["ticketTimeline",e],enabled:!!e,queryFn:async()=>{if(!e)return[];const{data:t,error:n}=await O.from("logs").select("*").eq("details->>ticket_id",e).order("created_at",{ascending:!0});if(n)throw n;return t??[]}}),mt={useDashboardMetrics:In,useAllTickets:Ln,useTicketById:Fn,useTicketCategories:Wn,useCreateTicket:An,useUpdateTicket:En,useTicketComments:Rn,useAddTicketComment:Bn,useTicketTimeline:Yn,useLogAuthors:On};function Ra({isOpen:e,onClose:t,categories:n}){var F;const{useCreateTicket:r}=mt,a=r(),[s,i]=_.useState(1),[l,d]=_.useState(""),[u,c]=_.useState(""),[v,h]=_.useState(((F=n[0])==null?void 0:F.id)??""),[y,f]=_.useState("Low"),{data:w=[]}=K({queryKey:["ticket_priorities"],queryFn:async()=>{const{data:N,error:B}=await O.from("ticket_priorities").select("id, name");if(B)throw B;const I=["Low","Medium","High","Critical"];return(N??[]).sort((G,X)=>I.indexOf(G.name)-I.indexOf(X.name))}}),b=()=>{var N;i(1),d(""),c(""),h(((N=n[0])==null?void 0:N.id)??""),f("Low")},D=()=>{if(!l.trim()){U("Subject is required");return}i(2)},k=async()=>{try{const{data:{user:N}}=await O.auth.getUser();if(!N){U("You must be logged in");return}if(!v){U("Please select a category");return}if(!y){U("Please select a priority");return}await a.mutateAsync({user_id:N.id,subject:l,description:u,category_id:v,priority:y,status:"open"}),ae("Ticket created successfully"),b(),t()}catch(N){const B=N instanceof Error?N.message:"Failed to create ticket";U(B)}};return o.jsx(Kt,{open:e,onOpenChange:N=>!N&&t(),children:o.jsxs(Vt,{className:"sm:max-w-[450px]",children:[o.jsxs(Qt,{children:[o.jsx($t,{children:"Create New Ticket"}),o.jsx(Zt,{children:"Fill in the details to create a support ticket."})]}),s===1&&o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(ve,{htmlFor:"subject",children:"Subject"}),o.jsx(Et,{id:"subject",value:l,onChange:N=>d(N.target.value),placeholder:"Brief summary of the issue"})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(ve,{htmlFor:"description",children:"Description"}),o.jsx(Ye,{id:"description",value:u,onChange:N=>c(N.target.value),placeholder:"Detailed explanation of the problem",rows:5})]})]}),s===2&&o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid gap-2",children:[o.jsx(ve,{children:"Category"}),o.jsxs(pe,{value:v,onValueChange:h,children:[o.jsx(ge,{children:o.jsx(xe,{placeholder:"Select category"})}),o.jsx(be,{children:n.map(N=>o.jsx(Z,{value:N.id,children:N.name},N.id))})]})]}),o.jsxs("div",{className:"grid gap-2",children:[o.jsx(ve,{children:"Priority"}),o.jsxs(pe,{value:y,onValueChange:f,children:[o.jsx(ge,{children:o.jsx(xe,{placeholder:"Select priority"})}),o.jsx(be,{children:w.map(N=>o.jsx(Z,{value:N.name,children:N.name},N.id))})]})]})]}),o.jsxs(Gt,{className:"flex justify-between",children:[s===2&&o.jsx(te,{variant:"outline",onClick:()=>i(1),children:"Back"}),s===1?o.jsx(te,{onClick:D,className:"btn-motion-primary",children:"Next"}):o.jsxs(te,{onClick:k,className:"btn-motion-primary",disabled:a.isPending,children:[a.isPending&&o.jsx(Rt,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Ticket"]})]})]})})}const Hn={open:{label:"Open",variant:"info",textClass:"text-info"},in_progress:{label:"In Progress",variant:"warning",textClass:"text-warning"},closed:{label:"Closed",variant:"success",textClass:"text-success"}},qn={low:{label:"Low",variant:"outline"},medium:{label:"Medium",variant:"info"},high:{label:"High",variant:"warning"},critical:{label:"Critical",variant:"destructive"}};function Un(e){const t=e==null?void 0:e.toLowerCase().replace(/\s+/g,"_");return t==="in_progress"?"in_progress":t==="closed"?"closed":"open"}function zn(e){const t=e==null?void 0:e.toLowerCase().trim();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":"low"}function Ba(e){return Hn[Un(e)]}function Ya(e){return qn[zn(e)]}const Ha=({title:e="Something Went Wrong",message:t="An unexpected error occurred. Please try again later."})=>o.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center text-red-500",children:[o.jsx(xn,{className:"h-16 w-16 mb-4"}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:e}),o.jsx("p",{className:"text-sm",children:t})]});var x=function(){return x=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},x.apply(this,arguments)};function Kn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function vt(e,t,n){for(var r=0,a=t.length,s;r<a;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function de(e){return e.mode==="multiple"}function ce(e){return e.mode==="range"}function we(e){return e.mode==="single"}var Vn={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Qn(e,t){return L(e,"LLLL y",t)}function $n(e,t){return L(e,"d",t)}function Zn(e,t){return L(e,"LLLL",t)}function Gn(e){return"".concat(e)}function Xn(e,t){return L(e,"cccccc",t)}function Jn(e,t){return L(e,"yyyy",t)}var er=Object.freeze({__proto__:null,formatCaption:Qn,formatDay:$n,formatMonthCaption:Zn,formatWeekNumber:Gn,formatWeekdayName:Xn,formatYearCaption:Jn}),tr=function(e,t,n){return L(e,"do MMMM (EEEE)",n)},nr=function(){return"Month: "},rr=function(){return"Go to next month"},ar=function(){return"Go to previous month"},or=function(e,t){return L(e,"cccc",t)},sr=function(e){return"Week n. ".concat(e)},ir=function(){return"Year: "},lr=Object.freeze({__proto__:null,labelDay:tr,labelMonthDropdown:nr,labelNext:rr,labelPrevious:ar,labelWeekNumber:sr,labelWeekday:or,labelYearDropdown:ir});function dr(){var e="buttons",t=Vn,n=Bt,r={},a={},s=1,i={},l=new Date;return{captionLayout:e,classNames:t,formatters:er,labels:lr,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:s,styles:i,today:l,mode:"default"}}function cr(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,a=e.toMonth,s=e.fromDate,i=e.toDate;return r?s=P(r):t&&(s=new Date(t,0,1)),a?i=Ee(a):n&&(i=new Date(n,11,31)),{fromDate:s?ye(s):void 0,toDate:i?ye(i):void 0}}var ht=_.createContext(void 0);function ur(e){var t,n=e.initialProps,r=dr(),a=cr(n),s=a.fromDate,i=a.toDate,l=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;l!=="buttons"&&(!s||!i)&&(l="buttons");var d;(we(n)||de(n)||ce(n))&&(d=n.onSelect);var u=x(x(x({},r),n),{captionLayout:l,classNames:x(x({},r.classNames),n.classNames),components:x({},n.components),formatters:x(x({},r.formatters),n.formatters),fromDate:s,labels:x(x({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:x(x({},r.modifiers),n.modifiers),modifiersClassNames:x(x({},r.modifiersClassNames),n.modifiersClassNames),onSelect:d,styles:x(x({},r.styles),n.styles),toDate:i});return o.jsx(ht.Provider,{value:u,children:e.children})}function j(){var e=_.useContext(ht);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function yt(e){var t=j(),n=t.locale,r=t.classNames,a=t.styles,s=t.formatters.formatCaption;return o.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:n})})}function fr(e){return o.jsx("svg",x({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:o.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function pt(e){var t,n,r=e.onChange,a=e.value,s=e.children,i=e.caption,l=e.className,d=e.style,u=j(),c=(n=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:fr;return o.jsxs("div",{className:l,style:d,children:[o.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),o.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:r,children:s}),o.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[i,o.jsx(c,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function mr(e){var t,n=j(),r=n.fromDate,a=n.toDate,s=n.styles,i=n.locale,l=n.formatters.formatMonthCaption,d=n.classNames,u=n.components,c=n.labels.labelMonthDropdown;if(!r)return o.jsx(o.Fragment,{});if(!a)return o.jsx(o.Fragment,{});var v=[];if(Pn(r,a))for(var h=P(r),y=r.getMonth();y<=a.getMonth();y++)v.push(Me(h,y));else for(var h=P(new Date),y=0;y<=11;y++)v.push(Me(h,y));var f=function(b){var D=Number(b.target.value),k=Me(P(e.displayMonth),D);e.onChange(k)},w=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:pt;return o.jsx(w,{name:"months","aria-label":c(),className:d.dropdown_month,style:s.dropdown_month,onChange:f,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:i}),children:v.map(function(b){return o.jsx("option",{value:b.getMonth(),children:l(b,{locale:i})},b.getMonth())})})}function vr(e){var t,n=e.displayMonth,r=j(),a=r.fromDate,s=r.toDate,i=r.locale,l=r.styles,d=r.classNames,u=r.components,c=r.formatters.formatYearCaption,v=r.labels.labelYearDropdown,h=[];if(!a)return o.jsx(o.Fragment,{});if(!s)return o.jsx(o.Fragment,{});for(var y=a.getFullYear(),f=s.getFullYear(),w=y;w<=f;w++)h.push(tt(Yt(new Date),w));var b=function(k){var F=tt(P(n),Number(k.target.value));e.onChange(F)},D=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:pt;return o.jsx(D,{name:"years","aria-label":v(),className:d.dropdown_year,style:l.dropdown_year,onChange:b,value:n.getFullYear(),caption:c(n,{locale:i}),children:h.map(function(k){return o.jsx("option",{value:k.getFullYear(),children:c(k,{locale:i})},k.getFullYear())})})}function hr(e,t){var n=_.useState(e),r=n[0],a=n[1],s=t===void 0?r:t;return[s,a]}function yr(e){var t=e.month,n=e.defaultMonth,r=e.today,a=t||n||r||new Date,s=e.toDate,i=e.fromDate,l=e.numberOfMonths,d=l===void 0?1:l;if(s&&ie(s,a)<0){var u=-1*(d-1);a=E(s,u)}return i&&ie(a,i)<0&&(a=i),P(a)}function pr(){var e=j(),t=yr(e),n=hr(t,e.month),r=n[0],a=n[1],s=function(i){var l;if(!e.disableNavigation){var d=P(i);a(d),(l=e.onMonthChange)===null||l===void 0||l.call(e,d)}};return[r,s]}function gr(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,a=P(e),s=P(E(a,r)),i=ie(s,a),l=[],d=0;d<i;d++){var u=E(a,d);l.push(u)}return n&&(l=l.reverse()),l}function xr(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=r?s:1,l=P(e);if(!n)return E(l,i);var d=ie(n,e);if(!(d<s))return E(l,i)}}function br(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=r?s:1,l=P(e);if(!n)return E(l,-i);var d=ie(l,n);if(!(d<=0))return E(l,-i)}}var gt=_.createContext(void 0);function _r(e){var t=j(),n=pr(),r=n[0],a=n[1],s=gr(r,t),i=xr(r,t),l=br(r,t),d=function(v){return s.some(function(h){return Be(v,h)})},u=function(v,h){d(v)||(h&&ft(v,h)?a(E(v,1+t.numberOfMonths*-1)):a(v))},c={currentMonth:r,displayMonths:s,goToMonth:a,goToDate:u,previousMonth:l,nextMonth:i,isDateDisplayed:d};return o.jsx(gt.Provider,{value:c,children:e.children})}function ue(){var e=_.useContext(gt);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function nt(e){var t,n=j(),r=n.classNames,a=n.styles,s=n.components,i=ue().goToMonth,l=function(c){i(E(c,e.displayIndex?-e.displayIndex:0))},d=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:yt,u=o.jsx(d,{id:e.id,displayMonth:e.displayMonth});return o.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[o.jsx("div",{className:r.vhidden,children:u}),o.jsx(mr,{onChange:l,displayMonth:e.displayMonth}),o.jsx(vr,{onChange:l,displayMonth:e.displayMonth})]})}function wr(e){return o.jsx("svg",x({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Nr(e){return o.jsx("svg",x({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var _e=_.forwardRef(function(e,t){var n=j(),r=n.classNames,a=n.styles,s=[r.button_reset,r.button];e.className&&s.push(e.className);var i=s.join(" "),l=x(x({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),o.jsx("button",x({},e,{ref:t,type:"button",className:i,style:l}))});function kr(e){var t,n,r=j(),a=r.dir,s=r.locale,i=r.classNames,l=r.styles,d=r.labels,u=d.labelPrevious,c=d.labelNext,v=r.components;if(!e.nextMonth&&!e.previousMonth)return o.jsx(o.Fragment,{});var h=u(e.previousMonth,{locale:s}),y=[i.nav_button,i.nav_button_previous].join(" "),f=c(e.nextMonth,{locale:s}),w=[i.nav_button,i.nav_button_next].join(" "),b=(t=v==null?void 0:v.IconRight)!==null&&t!==void 0?t:Nr,D=(n=v==null?void 0:v.IconLeft)!==null&&n!==void 0?n:wr;return o.jsxs("div",{className:i.nav,style:l.nav,children:[!e.hidePrevious&&o.jsx(_e,{name:"previous-month","aria-label":h,className:y,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?o.jsx(b,{className:i.nav_icon,style:l.nav_icon}):o.jsx(D,{className:i.nav_icon,style:l.nav_icon})}),!e.hideNext&&o.jsx(_e,{name:"next-month","aria-label":f,className:w,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?o.jsx(D,{className:i.nav_icon,style:l.nav_icon}):o.jsx(b,{className:i.nav_icon,style:l.nav_icon})})]})}function rt(e){var t=j().numberOfMonths,n=ue(),r=n.previousMonth,a=n.nextMonth,s=n.goToMonth,i=n.displayMonths,l=i.findIndex(function(f){return Be(e.displayMonth,f)}),d=l===0,u=l===i.length-1,c=t>1&&(d||!u),v=t>1&&(u||!d),h=function(){r&&s(r)},y=function(){a&&s(a)};return o.jsx(kr,{displayMonth:e.displayMonth,hideNext:c,hidePrevious:v,nextMonth:a,previousMonth:r,onPreviousClick:h,onNextClick:y})}function jr(e){var t,n=j(),r=n.classNames,a=n.disableNavigation,s=n.styles,i=n.captionLayout,l=n.components,d=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:yt,u;return a?u=o.jsx(d,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?u=o.jsx(nt,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?u=o.jsxs(o.Fragment,{children:[o.jsx(nt,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),o.jsx(rt,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=o.jsxs(o.Fragment,{children:[o.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(rt,{displayMonth:e.displayMonth,id:e.id})]}),o.jsx("div",{className:r.caption,style:s.caption,children:u})}function Dr(e){var t=j(),n=t.footer,r=t.styles,a=t.classNames.tfoot;return n?o.jsx("tfoot",{className:a,style:r.tfoot,children:o.jsx("tr",{children:o.jsx("td",{colSpan:8,children:n})})}):o.jsx(o.Fragment,{})}function Cr(e,t,n){for(var r=n?Ae(new Date):se(new Date,{locale:e,weekStartsOn:t}),a=[],s=0;s<7;s++){var i=S(r,s);a.push(i)}return a}function Mr(){var e=j(),t=e.classNames,n=e.styles,r=e.showWeekNumber,a=e.locale,s=e.weekStartsOn,i=e.ISOWeek,l=e.formatters.formatWeekdayName,d=e.labels.labelWeekday,u=Cr(a,s,i);return o.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&o.jsx("td",{style:n.head_cell,className:t.head_cell}),u.map(function(c,v){return o.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":d(c,{locale:a}),children:l(c,{locale:a})},v)})]})}function Sr(){var e,t=j(),n=t.classNames,r=t.styles,a=t.components,s=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:Mr;return o.jsx("thead",{style:r.head,className:n.head,children:o.jsx(s,{})})}function Tr(e){var t=j(),n=t.locale,r=t.formatters.formatDay;return o.jsx(o.Fragment,{children:r(e.date,{locale:n})})}var He=_.createContext(void 0);function Pr(e){if(!de(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return o.jsx(He.Provider,{value:t,children:e.children})}return o.jsx(Or,{initialProps:e.initialProps,children:e.children})}function Or(e){var t=e.initialProps,n=e.children,r=t.selected,a=t.min,s=t.max,i=function(u,c,v){var h,y;(h=t.onDayClick)===null||h===void 0||h.call(t,u,c,v);var f=!!(c.selected&&a&&(r==null?void 0:r.length)===a);if(!f){var w=!!(!c.selected&&s&&(r==null?void 0:r.length)===s);if(!w){var b=r?vt([],r):[];if(c.selected){var D=b.findIndex(function(k){return T(u,k)});b.splice(D,1)}else b.push(u);(y=t.onSelect)===null||y===void 0||y.call(t,b,u,c,v)}}},l={disabled:[]};r&&l.disabled.push(function(u){var c=s&&r.length>s-1,v=r.some(function(h){return T(h,u)});return!!(c&&!v)});var d={selected:r,onDayClick:i,modifiers:l};return o.jsx(He.Provider,{value:d,children:n})}function qe(){var e=_.useContext(He);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Ir(e,t){var n=t||{},r=n.from,a=n.to;return r&&a?T(a,e)&&T(r,e)?void 0:T(a,e)?{from:a,to:void 0}:T(r,e)?void 0:Le(r,e)?{from:e,to:a}:{from:r,to:e}:a?Le(e,a)?{from:a,to:e}:{from:e,to:a}:r?ft(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var Ue=_.createContext(void 0);function Lr(e){if(!ce(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return o.jsx(Ue.Provider,{value:t,children:e.children})}return o.jsx(Fr,{initialProps:e.initialProps,children:e.children})}function Fr(e){var t=e.initialProps,n=e.children,r=t.selected,a=r||{},s=a.from,i=a.to,l=t.min,d=t.max,u=function(y,f,w){var b,D;(b=t.onDayClick)===null||b===void 0||b.call(t,y,f,w);var k=Ir(y,r);(D=t.onSelect)===null||D===void 0||D.call(t,k,y,f,w)},c={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(c.range_start=[s],i?(c.range_end=[i],T(s,i)||(c.range_middle=[{after:s,before:i}])):c.range_end=[s]):i&&(c.range_start=[i],c.range_end=[i]),l&&(s&&!i&&c.disabled.push({after:Ce(s,l-1),before:S(s,l-1)}),s&&i&&c.disabled.push({after:s,before:S(s,l-1)}),!s&&i&&c.disabled.push({after:Ce(i,l-1),before:S(i,l-1)})),d){if(s&&!i&&(c.disabled.push({before:S(s,-d+1)}),c.disabled.push({after:S(s,d-1)})),s&&i){var v=z(i,s)+1,h=d-v;c.disabled.push({before:Ce(s,h)}),c.disabled.push({after:S(i,h)})}!s&&i&&(c.disabled.push({before:S(i,-d+1)}),c.disabled.push({after:S(i,d-1)}))}return o.jsx(Ue.Provider,{value:{selected:r,onDayClick:u,modifiers:c},children:n})}function ze(){var e=_.useContext(Ue);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function he(e){return Array.isArray(e)?vt([],e):e!==void 0?[e]:[]}function Wr(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],a=n[1];t[r]=he(a)}),t}var R;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(R||(R={}));var Ar=R.Selected,q=R.Disabled,Er=R.Hidden,Rr=R.Today,Se=R.RangeEnd,Te=R.RangeMiddle,Pe=R.RangeStart,Br=R.Outside;function Yr(e,t,n){var r,a=(r={},r[Ar]=he(e.selected),r[q]=he(e.disabled),r[Er]=he(e.hidden),r[Rr]=[e.today],r[Se]=[],r[Te]=[],r[Pe]=[],r[Br]=[],r);return e.fromDate&&a[q].push({before:e.fromDate}),e.toDate&&a[q].push({after:e.toDate}),de(e)?a[q]=a[q].concat(t.modifiers[q]):ce(e)&&(a[q]=a[q].concat(n.modifiers[q]),a[Pe]=n.modifiers[Pe],a[Te]=n.modifiers[Te],a[Se]=n.modifiers[Se]),a}var xt=_.createContext(void 0);function Hr(e){var t=j(),n=qe(),r=ze(),a=Yr(t,n,r),s=Wr(t.modifiers),i=x(x({},a),s);return o.jsx(xt.Provider,{value:i,children:e.children})}function bt(){var e=_.useContext(xt);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function qr(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Ur(e){return!!(e&&typeof e=="object"&&"from"in e)}function zr(e){return!!(e&&typeof e=="object"&&"after"in e)}function Kr(e){return!!(e&&typeof e=="object"&&"before"in e)}function Vr(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Qr(e,t){var n,r=t.from,a=t.to;if(r&&a){var s=z(a,r)<0;s&&(n=[a,r],r=n[0],a=n[1]);var i=z(e,r)>=0&&z(a,e)>=0;return i}return a?T(a,e):r?T(r,e):!1}function $r(e){return st(e)}function Zr(e){return Array.isArray(e)&&e.every(st)}function Gr(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if($r(n))return T(e,n);if(Zr(n))return n.includes(e);if(Ur(n))return Qr(e,n);if(Vr(n))return n.dayOfWeek.includes(e.getDay());if(qr(n)){var r=z(n.before,e),a=z(n.after,e),s=r>0,i=a<0,l=Le(n.before,n.after);return l?i&&s:s||i}return zr(n)?z(e,n.after)>0:Kr(n)?z(n.before,e)>0:typeof n=="function"?n(e):!1})}function Ke(e,t,n){var r=Object.keys(t).reduce(function(s,i){var l=t[i];return Gr(e,l)&&s.push(i),s},[]),a={};return r.forEach(function(s){return a[s]=!0}),n&&!Be(e,n)&&(a.outside=!0),a}function Xr(e,t){for(var n=P(e[0]),r=Ee(e[e.length-1]),a,s,i=n;i<=r;){var l=Ke(i,t),d=!l.disabled&&!l.hidden;if(!d){i=S(i,1);continue}if(l.selected)return i;l.today&&!s&&(s=i),a||(a=i),i=S(i,1)}return s||a}var Jr=365;function _t(e,t){var n=t.moveBy,r=t.direction,a=t.context,s=t.modifiers,i=t.retry,l=i===void 0?{count:0,lastFocused:e}:i,d=a.weekStartsOn,u=a.fromDate,c=a.toDate,v=a.locale,h={day:S,week:Ie,month:E,year:Nn,startOfWeek:function(b){return a.ISOWeek?Ae(b):se(b,{locale:v,weekStartsOn:d})},endOfWeek:function(b){return a.ISOWeek?ut(b):Re(b,{locale:v,weekStartsOn:d})}},y=h[n](e,r==="after"?1:-1);r==="before"&&u?y=kn([u,y]):r==="after"&&c&&(y=jn([c,y]));var f=!0;if(s){var w=Ke(y,s);f=!w.disabled&&!w.hidden}return f?y:l.count>Jr?l.lastFocused:_t(y,{moveBy:n,direction:r,context:a,modifiers:s,retry:x(x({},l),{count:l.count+1})})}var wt=_.createContext(void 0);function ea(e){var t=ue(),n=bt(),r=_.useState(),a=r[0],s=r[1],i=_.useState(),l=i[0],d=i[1],u=Xr(t.displayMonths,n),c=a??(l&&t.isDateDisplayed(l))?l:u,v=function(){d(a),s(void 0)},h=function(b){s(b)},y=j(),f=function(b,D){if(a){var k=_t(a,{moveBy:b,direction:D,context:y,modifiers:n});T(a,k)||(t.goToDate(k,a),h(k))}},w={focusedDay:a,focusTarget:c,blur:v,focus:h,focusDayAfter:function(){return f("day","after")},focusDayBefore:function(){return f("day","before")},focusWeekAfter:function(){return f("week","after")},focusWeekBefore:function(){return f("week","before")},focusMonthBefore:function(){return f("month","before")},focusMonthAfter:function(){return f("month","after")},focusYearBefore:function(){return f("year","before")},focusYearAfter:function(){return f("year","after")},focusStartOfWeek:function(){return f("startOfWeek","before")},focusEndOfWeek:function(){return f("endOfWeek","after")}};return o.jsx(wt.Provider,{value:w,children:e.children})}function Ve(){var e=_.useContext(wt);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function ta(e,t){var n=bt(),r=Ke(e,n,t);return r}var Qe=_.createContext(void 0);function na(e){if(!we(e.initialProps)){var t={selected:void 0};return o.jsx(Qe.Provider,{value:t,children:e.children})}return o.jsx(ra,{initialProps:e.initialProps,children:e.children})}function ra(e){var t=e.initialProps,n=e.children,r=function(s,i,l){var d,u,c;if((d=t.onDayClick)===null||d===void 0||d.call(t,s,i,l),i.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,s,i,l);return}(c=t.onSelect)===null||c===void 0||c.call(t,s,s,i,l)},a={selected:t.selected,onDayClick:r};return o.jsx(Qe.Provider,{value:a,children:n})}function Nt(){var e=_.useContext(Qe);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function aa(e,t){var n=j(),r=Nt(),a=qe(),s=ze(),i=Ve(),l=i.focusDayAfter,d=i.focusDayBefore,u=i.focusWeekAfter,c=i.focusWeekBefore,v=i.blur,h=i.focus,y=i.focusMonthBefore,f=i.focusMonthAfter,w=i.focusYearBefore,b=i.focusYearAfter,D=i.focusStartOfWeek,k=i.focusEndOfWeek,F=function(g){var p,Y,$,J;we(n)?(p=r.onDayClick)===null||p===void 0||p.call(r,e,t,g):de(n)?(Y=a.onDayClick)===null||Y===void 0||Y.call(a,e,t,g):ce(n)?($=s.onDayClick)===null||$===void 0||$.call(s,e,t,g):(J=n.onDayClick)===null||J===void 0||J.call(n,e,t,g)},N=function(g){var p;h(e),(p=n.onDayFocus)===null||p===void 0||p.call(n,e,t,g)},B=function(g){var p;v(),(p=n.onDayBlur)===null||p===void 0||p.call(n,e,t,g)},I=function(g){var p;(p=n.onDayMouseEnter)===null||p===void 0||p.call(n,e,t,g)},G=function(g){var p;(p=n.onDayMouseLeave)===null||p===void 0||p.call(n,e,t,g)},X=function(g){var p;(p=n.onDayPointerEnter)===null||p===void 0||p.call(n,e,t,g)},W=function(g){var p;(p=n.onDayPointerLeave)===null||p===void 0||p.call(n,e,t,g)},ne=function(g){var p;(p=n.onDayTouchCancel)===null||p===void 0||p.call(n,e,t,g)},$e=function(g){var p;(p=n.onDayTouchEnd)===null||p===void 0||p.call(n,e,t,g)},V=function(g){var p;(p=n.onDayTouchMove)===null||p===void 0||p.call(n,e,t,g)},re=function(g){var p;(p=n.onDayTouchStart)===null||p===void 0||p.call(n,e,t,g)},fe=function(g){var p;(p=n.onDayKeyUp)===null||p===void 0||p.call(n,e,t,g)},Ne=function(g){var p;switch(g.key){case"ArrowLeft":g.preventDefault(),g.stopPropagation(),n.dir==="rtl"?l():d();break;case"ArrowRight":g.preventDefault(),g.stopPropagation(),n.dir==="rtl"?d():l();break;case"ArrowDown":g.preventDefault(),g.stopPropagation(),u();break;case"ArrowUp":g.preventDefault(),g.stopPropagation(),c();break;case"PageUp":g.preventDefault(),g.stopPropagation(),g.shiftKey?w():y();break;case"PageDown":g.preventDefault(),g.stopPropagation(),g.shiftKey?b():f();break;case"Home":g.preventDefault(),g.stopPropagation(),D();break;case"End":g.preventDefault(),g.stopPropagation(),k();break}(p=n.onDayKeyDown)===null||p===void 0||p.call(n,e,t,g)},ke={onClick:F,onFocus:N,onBlur:B,onKeyDown:Ne,onKeyUp:fe,onMouseEnter:I,onMouseLeave:G,onPointerEnter:X,onPointerLeave:W,onTouchCancel:ne,onTouchEnd:$e,onTouchMove:V,onTouchStart:re};return ke}function oa(){var e=j(),t=Nt(),n=qe(),r=ze(),a=we(e)?t.selected:de(e)?n.selected:ce(e)?r.selected:void 0;return a}function sa(e){return Object.values(R).includes(e)}function ia(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var a=e.modifiersClassNames[r];if(a)n.push(a);else if(sa(r)){var s=e.classNames["day_".concat(r)];s&&n.push(s)}}),n}function la(e,t){var n=x({},e.styles.day);return Object.keys(t).forEach(function(r){var a;n=x(x({},n),(a=e.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function da(e,t,n){var r,a,s,i=j(),l=Ve(),d=ta(e,t),u=aa(e,d),c=oa(),v=!!(i.onDayClick||i.mode!=="default");_.useEffect(function(){var I;d.outside||l.focusedDay&&v&&T(l.focusedDay,e)&&((I=n.current)===null||I===void 0||I.focus())},[l.focusedDay,e,n,v,d.outside]);var h=ia(i,d).join(" "),y=la(i,d),f=!!(d.outside&&!i.showOutsideDays||d.hidden),w=(s=(a=i.components)===null||a===void 0?void 0:a.DayContent)!==null&&s!==void 0?s:Tr,b=o.jsx(w,{date:e,displayMonth:t,activeModifiers:d}),D={style:y,className:h,children:b,role:"gridcell"},k=l.focusTarget&&T(l.focusTarget,e)&&!d.outside,F=l.focusedDay&&T(l.focusedDay,e),N=x(x(x({},D),(r={disabled:d.disabled,role:"gridcell"},r["aria-selected"]=d.selected,r.tabIndex=F||k?0:-1,r)),u),B={isButton:v,isHidden:f,activeModifiers:d,selectedDays:c,buttonProps:N,divProps:D};return B}function ca(e){var t=_.useRef(null),n=da(e.date,e.displayMonth,t);return n.isHidden?o.jsx("div",{role:"gridcell"}):n.isButton?o.jsx(_e,x({name:"day",ref:t},n.buttonProps)):o.jsx("div",x({},n.divProps))}function ua(e){var t=e.number,n=e.dates,r=j(),a=r.onWeekNumberClick,s=r.styles,i=r.classNames,l=r.locale,d=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,c=u(Number(t),{locale:l});if(!a)return o.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:c});var v=d(Number(t),{locale:l}),h=function(y){a(t,n,y)};return o.jsx(_e,{name:"week-number","aria-label":v,className:i.weeknumber,style:s.weeknumber,onClick:h,children:c})}function fa(e){var t,n,r=j(),a=r.styles,s=r.classNames,i=r.showWeekNumber,l=r.components,d=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:ca,u=(n=l==null?void 0:l.WeekNumber)!==null&&n!==void 0?n:ua,c;return i&&(c=o.jsx("td",{className:s.cell,style:a.cell,children:o.jsx(u,{number:e.weekNumber,dates:e.dates})})),o.jsxs("tr",{className:s.row,style:a.row,children:[c,e.dates.map(function(v){return o.jsx("td",{className:s.cell,style:a.cell,role:"presentation",children:o.jsx(d,{displayMonth:e.displayMonth,date:v})},Mn(v))})]})}function at(e,t,n){for(var r=n!=null&&n.ISOWeek?ut(t):Re(t,n),a=n!=null&&n.ISOWeek?Ae(e):se(e,n),s=z(r,a),i=[],l=0;l<=s;l++)i.push(S(a,l));var d=i.reduce(function(u,c){var v=n!=null&&n.ISOWeek?Ht(c):qt(c,n),h=u.find(function(y){return y.weekNumber===v});return h?(h.dates.push(c),u):(u.push({weekNumber:v,dates:[c]}),u)},[]);return d}function ma(e,t){var n=at(P(e),Ee(e),t);if(t!=null&&t.useFixedWeeks){var r=Tn(e,t);if(r<6){var a=n[n.length-1],s=a.dates[a.dates.length-1],i=Ie(s,6-r),l=at(Ie(s,1),i,t);n.push.apply(n,l)}}return n}function va(e){var t,n,r,a=j(),s=a.locale,i=a.classNames,l=a.styles,d=a.hideHead,u=a.fixedWeeks,c=a.components,v=a.weekStartsOn,h=a.firstWeekContainsDate,y=a.ISOWeek,f=ma(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:y,locale:s,weekStartsOn:v,firstWeekContainsDate:h}),w=(t=c==null?void 0:c.Head)!==null&&t!==void 0?t:Sr,b=(n=c==null?void 0:c.Row)!==null&&n!==void 0?n:fa,D=(r=c==null?void 0:c.Footer)!==null&&r!==void 0?r:Dr;return o.jsxs("table",{id:e.id,className:i.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!d&&o.jsx(w,{}),o.jsx("tbody",{className:i.tbody,style:l.tbody,children:f.map(function(k){return o.jsx(b,{displayMonth:e.displayMonth,dates:k.dates,weekNumber:k.weekNumber},k.weekNumber)})}),o.jsx(D,{displayMonth:e.displayMonth})]})}function ha(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var ya=ha()?_.useLayoutEffect:_.useEffect,Oe=!1,pa=0;function ot(){return"react-day-picker-".concat(++pa)}function ga(e){var t,n=e??(Oe?ot():null),r=_.useState(n),a=r[0],s=r[1];return ya(function(){a===null&&s(ot())},[]),_.useEffect(function(){Oe===!1&&(Oe=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function xa(e){var t,n,r=j(),a=r.dir,s=r.classNames,i=r.styles,l=r.components,d=ue().displayMonths,u=ga(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),c=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,v=[s.month],h=i.month,y=e.displayIndex===0,f=e.displayIndex===d.length-1,w=!y&&!f;a==="rtl"&&(t=[y,f],f=t[0],y=t[1]),y&&(v.push(s.caption_start),h=x(x({},h),i.caption_start)),f&&(v.push(s.caption_end),h=x(x({},h),i.caption_end)),w&&(v.push(s.caption_between),h=x(x({},h),i.caption_between));var b=(n=l==null?void 0:l.Caption)!==null&&n!==void 0?n:jr;return o.jsxs("div",{className:v.join(" "),style:h,children:[o.jsx(b,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(va,{id:c,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function ba(e){var t=j(),n=t.classNames,r=t.styles;return o.jsx("div",{className:n.months,style:r.months,children:e.children})}function _a(e){var t,n,r=e.initialProps,a=j(),s=Ve(),i=ue(),l=_.useState(!1),d=l[0],u=l[1];_.useEffect(function(){a.initialFocus&&s.focusTarget&&(d||(s.focus(s.focusTarget),u(!0)))},[a.initialFocus,d,s.focus,s.focusTarget,s]);var c=[a.classNames.root,a.className];a.numberOfMonths>1&&c.push(a.classNames.multiple_months),a.showWeekNumber&&c.push(a.classNames.with_weeknumber);var v=x(x({},a.styles.root),a.style),h=Object.keys(r).filter(function(f){return f.startsWith("data-")}).reduce(function(f,w){var b;return x(x({},f),(b={},b[w]=r[w],b))},{}),y=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:ba;return o.jsx("div",x({className:c.join(" "),style:v,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},h,{children:o.jsx(y,{children:i.displayMonths.map(function(f,w){return o.jsx(xa,{displayIndex:w,displayMonth:f},w)})})}))}function wa(e){var t=e.children,n=Kn(e,["children"]);return o.jsx(ur,{initialProps:n,children:o.jsx(_r,{children:o.jsx(na,{initialProps:n,children:o.jsx(Pr,{initialProps:n,children:o.jsx(Lr,{initialProps:n,children:o.jsx(Hr,{children:o.jsx(ea,{children:t})})})})})})})}function Na(e){return o.jsx(wa,x({},e,{children:o.jsx(_a,{initialProps:e})}))}function kt({className:e,classNames:t,showOutsideDays:n=!0,...r}){return o.jsx(Na,{showOutsideDays:n,className:A("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:A(et({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:A("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",r.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:A(et({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:()=>o.jsx(en,{className:"h-4 w-4"}),IconRight:()=>o.jsx(Jt,{className:"h-4 w-4"})},...r})}kt.displayName="Calendar";const ka=tn,ja=nn,jt=_.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>o.jsx(rn,{children:o.jsx(it,{ref:a,align:t,sideOffset:n,className:A("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));jt.displayName=it.displayName;function Da(){return K({queryKey:["it-users"],queryFn:async()=>{const{data:e,error:t}=await O.from("profiles").select("id, name, role").in("role",["it","admin"]);if(t)throw t;return e??[]}})}const Dt=_.forwardRef(({className:e,children:t,...n},r)=>o.jsxs(lt,{ref:r,className:A("relative overflow-hidden",e),...n,children:[o.jsx(an,{className:"h-full w-full rounded-[inherit]",children:t}),o.jsx(Ct,{}),o.jsx(on,{})]}));Dt.displayName=lt.displayName;const Ct=_.forwardRef(({className:e,orientation:t="vertical",...n},r)=>o.jsx(dt,{ref:r,orientation:t,className:A("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:o.jsx(sn,{className:A("relative flex-1 rounded-full bg-border",t==="vertical"&&"w-full",t==="horizontal"&&"h-full")})}));Ct.displayName=dt.displayName;const ee=_.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>o.jsx(ct,{ref:a,decorative:n,orientation:t,className:A("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));ee.displayName=ct.displayName;function Ca({className:e,...t}){return o.jsx("div",{className:A("animate-pulse rounded-md bg-primary/10",e),...t})}const Ma=e=>{switch(e){case"ticket.created":return{icon:cn,color:"text-emerald-500"};case"ticket.status_changed":return{icon:bn,color:"text-indigo-500"};case"ticket.due_date_changed":return{icon:_n,color:"text-orange-500"};case"ticket.assigned":return{icon:dn,color:"text-blue-500"};case"ticket.unassigned":return{icon:ln,color:"text-gray-500"};case"ticket.comment_added":return{icon:wn,color:"text-purple-500"};default:return{icon:gn,color:"text-muted-foreground"}}};function qa({categories:e}){const{ticketId:t,isOpen:n,closeDrawer:r}=Ut(),a=t??void 0,{useTicketById:s,useUpdateTicket:i,useTicketComments:l,useAddTicketComment:d,useTicketTimeline:u,useLogAuthors:c}=mt,v=s(a),h=l(a),y=u(a),f=v.data,w=h.data??[],b=y.data??[],D=[...b.filter(m=>m.action!=="ticket.comment_added").map(m=>({type:"log",id:m.id,created_at:m.created_at,user_id:m.user_id,action:m.action,details:m.details})),...w.map(m=>({type:"comment",id:m.id,created_at:m.created_at,user_id:m.user_id,comment_text:m.comment_text}))].sort((m,M)=>{const Q=new Date(m.created_at??0);return new Date(M.created_at??0).getTime()-Q.getTime()}),{mutate:k,isPending:F}=i(),{mutate:N,isPending:B}=d(),{session:I}=zt(),{role:G}=Xt(),{data:X}=Da(),W=I==null?void 0:I.user,ne=G==="admin"||G==="it",V=c(b).data??{},[re,fe]=_.useState(""),[Ne,ke]=_.useState(""),[g,p]=_.useState(""),[Y,$]=_.useState(),[J,je]=_.useState("09:00");_.useEffect(()=>{f!=null&&f.status&&ke(f.status)},[f==null?void 0:f.status]),_.useEffect(()=>{p((f==null?void 0:f.assigned_to)??"")},[f==null?void 0:f.assigned_to]),_.useEffect(()=>{if(f!=null&&f.due_at){const m=new Date(f.due_at);$(m),je(m.toISOString().slice(11,16))}else $(void 0),je("09:00")},[f==null?void 0:f.due_at]);const Mt=m=>{!W||!t||k({id:t,updates:{status:m},userId:W.id},{onSuccess:()=>ae("Status updated"),onError:M=>U(M.message)})},St=m=>{if(!W||!t)return;const M=m||"";p(M),k({id:t,updates:{assigned_to:M||null},userId:W.id},{onSuccess:()=>ae("Ticket assigned"),onError:Q=>U(Q.message)})},Tt=()=>{!W||!t||!re.trim()||N({ticket_id:t,user_id:W.id,comment_text:re.trim()},{onSuccess:()=>{fe(""),ae("Comment added")},onError:m=>U(m.message)})},Pt=()=>{if(!f||!W||!Y)return;const[m,M]=J.split(":").map(Number),Q=new Date(Y);Q.setHours(m,M,0),k({id:f.id,updates:{due_at:Q.toISOString()},userId:W.id},{onSuccess:()=>ae("Due date updated"),onError:me=>U(me.message)})},Ot=new Map(e.map(m=>[m.id,m.name])),It=m=>m?Ot.get(m)??"N/A":"N/A",Lt=!!(f!=null&&f.due_at)&&new Date(f.due_at).getTime()<Date.now()&&f.status!=="closed",De=new Map((X??[]).map(m=>[m.id,m.name??m.id]));return o.jsx(un,{open:n,onOpenChange:m=>!m&&r(),children:o.jsx(fn,{className:"h-[90%] mt-24",children:o.jsx(Dt,{className:"h-full",children:o.jsxs("div",{className:"mx-auto w-full max-w-3xl p-4",children:[o.jsxs(mn,{children:[o.jsx(vn,{children:"Ticket Details"}),o.jsx(hn,{children:"View the selected ticket information, comments and history"})]}),t?v.isLoading?o.jsx(Ca,{className:"h-40 w-full"}):f?o.jsxs(o.Fragment,{children:[o.jsxs("h2",{className:"text-xl font-bold mb-2 flex items-center gap-2",children:[f.title,Lt&&o.jsx(yn,{variant:"destructive",children:"Overdue"})]}),o.jsx(ee,{}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 my-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),o.jsx("p",{children:f.description||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Category"}),o.jsx("p",{children:It(f.category_id)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Created At"}),o.jsx("p",{className:"text-muted-foreground",children:f.created_at?L(new Date(f.created_at),"MMM dd, yyyy HH:mm"):""})]})]}),o.jsx(ee,{}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 my-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),o.jsxs(pe,{value:Ne,onValueChange:m=>Mt(m),disabled:!ne||F,children:[o.jsx(ge,{className:`\r
                          w-[180px]\r
                          bg-white\r
                          border border-gray-300\r
                          text-gray-900\r
                          shadow-sm\r
                          hover:bg-gray-50\r
                          focus:ring-2 focus:ring-blue-500\r
                        `,children:o.jsx(xe,{placeholder:"Select status"})}),o.jsxs(be,{className:`\r
                            bg-white\r
                            text-gray-900\r
                            border\r
                            shadow-lg\r
                            z-50\r
                          `,children:[o.jsx(Z,{value:"open",className:"focus:bg-muted",children:"Open"}),o.jsx(Z,{value:"in_progress",className:"focus:bg-muted",children:"In Progress"}),o.jsx(Z,{value:"closed",className:"focus:bg-muted",children:"Closed"})]})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Assigned To"}),ne?o.jsxs(pe,{value:g??"",onValueChange:St,children:[o.jsx(ge,{className:`\r
                              w-[180px]\r
                              bg-card\r
                              border border-border\r
                              text-foreground\r
                              shadow-sm\r
                              hover:bg-muted\r
                              focus:ring-2 focus:ring-ring\r
                            `,children:o.jsx(xe,{placeholder:"Unassigned"})}),o.jsxs(be,{className:`\r
                              z-[9999]\r
                              bg-card\r
                              border border-border\r
                              shadow-xl\r
                            `,children:[o.jsx(Z,{value:"",children:o.jsx("span",{className:"text-muted-foreground",children:"Unassigned"})}),(X??[]).map(m=>o.jsx(Z,{value:m.id,children:m.name||m.id},m.id))]})]}):o.jsx("p",{children:f.assigned_to?De.get(f.assigned_to):"Unassigned"})]})]}),o.jsx(ee,{}),o.jsxs("div",{className:"my-4",children:[o.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Due Date"}),ne?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(ka,{children:[o.jsx(ja,{asChild:!0,children:o.jsx(te,{variant:"outline",size:"sm",className:`\r
                                bg-card\r
                                border border-border\r
                                shadow-sm\r
                                hover:bg-muted\r
                              `,children:Y?L(Y,"MMM dd, yyyy"):"Pick date"})}),o.jsx(jt,{className:`\r
                              w-auto\r
                              p-0\r
                              bg-card\r
                              border border-border\r
                              shadow-xl\r
                              z-[9999]\r
                            `,children:o.jsx(kt,{mode:"single",selected:Y,onSelect:$,initialFocus:!0})})]}),o.jsx("input",{type:"time",value:J,onChange:m=>je(m.target.value),className:`
                            h-9
                            rounded-md
                            bg-card
                            border border-border
                            px-2
                            text-sm
                            shadow-sm
                          `}),o.jsx(te,{size:"sm",onClick:Pt,disabled:F||!Y,children:"Save"})]}):o.jsx("p",{children:f.due_at?L(new Date(f.due_at),"MMM dd, yyyy"):"N/A"})]}),o.jsx(ee,{}),o.jsx("h3",{className:"font-semibold my-4",children:"Activity"}),o.jsx("div",{className:"space-y-4",children:D.map(m=>{var Ze,Ge;if(m.type==="comment"){const H=m.user_id&&V[m.user_id]?V[m.user_id].name||V[m.user_id].email:"User";return o.jsxs("div",{className:"relative pl-8",children:[o.jsx("span",{className:"absolute left-0 top-1",children:""}),o.jsxs("p",{className:"text-sm font-medium",children:[H," commented"]}),o.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:m.comment_text}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:m.created_at?L(new Date(m.created_at),"MMM dd, yyyy HH:mm"):""})]},`c-${m.id}`)}let M=pn(m.action,m.details);if(m.action==="ticket.assigned"){const H=(Ze=m.details)==null?void 0:Ze.to;M={title:"Ticket assigned",description:`Assigned to ${H?De.get(H)??H:""}`}}if(m.action==="ticket.unassigned"){const H=(Ge=m.details)==null?void 0:Ge.from,Xe=H?De.get(H)??H:"";M={title:"Ticket unassigned",description:H?`Unassigned from ${Xe}`:void 0}}const{icon:Q,color:me}=Ma(m.action),Ft=m.user_id&&V[m.user_id]?V[m.user_id].name||V[m.user_id].email:"System";return o.jsxs("div",{className:"relative pl-8",children:[o.jsx("span",{className:`absolute left-0 top-1 ${me}`,children:o.jsx(Q,{size:16})}),o.jsxs("p",{className:"text-sm font-medium",children:[M.title,o.jsxs("span",{className:"text-muted-foreground font-normal",children:[" ","by ",Ft]})]}),M.description&&o.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:M.description}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:m.created_at?L(new Date(m.created_at),"MMM dd, yyyy HH:mm"):""})]},`l-${m.id}`)})}),o.jsx(ee,{className:"my-6"}),o.jsx(Ye,{placeholder:"Add a comment...",value:re,onChange:m=>fe(m.target.value)}),o.jsx(te,{className:"mt-2",onClick:Tt,disabled:!W||B,children:"Add Comment"})]}):o.jsx("p",{className:"text-center text-muted-foreground",children:"Ticket not found"}):o.jsx("p",{className:"text-center text-muted-foreground",children:"No ticket selected"})]})})})})}export{xn as A,Ra as C,Ha as E,Ca as S,qa as T,Ya as a,gn as b,Ba as g,mt as u};
