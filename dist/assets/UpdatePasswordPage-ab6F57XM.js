import{u as C,h as F,r as c,j as s,L as T}from"./vendor-react-CqgMBxNQ.js";import{u as U,a as I,o as V,s as m}from"./schemas-CadPpU1p.js";import{s as l,n as i,c as t,B as E,a as L}from"./index-DFoI8Gyt.js";import{C as x,a as u,b as p,c as h,d as f}from"./card-CCsMzs-c.js";import{I as w}from"./input-CmXEoJvQ.js";import{F as M,a as j,b as g,c as N,d as b,e as k}from"./form-xBLtdWGr.js";import{m as o}from"./proxy-Cn5sRzkl.js";import"./vendor-radix-DW-K601O.js";import"./vendor-supabase-CegkeNa5.js";import"./vendor-tanstack-DVpCzg3k.js";import"./label-B9UwnXR4.js";const _=V({password:m().min(8,{message:"Password must be at least 8 characters."}),confirmPassword:m().min(8,{message:"Confirm password must be at least 8 characters."})}).refine(r=>r.password===r.confirmPassword,{message:"Passwords don't match.",path:["confirmPassword"]}),O=()=>{const r=C(),[d]=F(),[y,P]=c.useState(!1),a=U({resolver:I(_),defaultValues:{password:"",confirmPassword:""}});c.useEffect(()=>{const e=d.get("access_token"),n=d.get("refresh_token");e&&n?l.auth.setSession({access_token:e,refresh_token:n}).then(({error:S})=>{S?(i("Invalid Token","The password reset link is invalid or expired."),r("/forgot-password")):P(!0)}):(i("Missing Token","No password reset token found. Please use the link from your email."),r("/forgot-password"))},[d,r]);const v=async e=>{const{error:n}=await l.auth.updateUser({password:e.password});n?i("Password Update Failed",n.message):(L("Password Updated","Your password has been updated successfully. You can now log in."),r("/login"))};return y?s.jsx("div",{className:"min-h-screen bg-background",children:s.jsx("div",{className:"mx-auto flex min-h-screen max-w-md items-center px-6 py-12",children:s.jsxs(o.div,{className:"w-full space-y-6",...t(0),children:[s.jsxs(o.div,{className:"space-y-2 text-center",...t(.04),children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-muted-foreground",children:"Neturai IT Manager"}),s.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Update Password"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a new password to secure your account."})]}),s.jsx(o.div,{...t(.08),children:s.jsxs(x,{className:"border-muted/60 shadow-sm",children:[s.jsxs(u,{children:[s.jsx(p,{className:"text-lg",children:"Update Password"}),s.jsx(h,{children:"Choose a strong password you do not reuse."})]}),s.jsx(f,{children:s.jsx(M,{...a,children:s.jsxs("form",{onSubmit:a.handleSubmit(v),className:"grid gap-4",children:[s.jsx(j,{control:a.control,name:"password",render:({field:e})=>s.jsxs(g,{children:[s.jsx(N,{children:"New Password"}),s.jsx(b,{children:s.jsx(w,{id:"password",type:"password",required:!0,...e})}),s.jsx(k,{})]})}),s.jsx(j,{control:a.control,name:"confirmPassword",render:({field:e})=>s.jsxs(g,{children:[s.jsx(N,{children:"Confirm New Password"}),s.jsx(b,{children:s.jsx(w,{id:"confirmPassword",type:"password",required:!0,...e})}),s.jsx(k,{})]})}),s.jsx(E,{type:"submit",className:"btn-motion-primary w-full",disabled:a.formState.isSubmitting,children:a.formState.isSubmitting?"Updating...":"Update Password"})]})})})]})})]})})}):s.jsx("div",{className:"min-h-screen bg-background",children:s.jsx("div",{className:"mx-auto flex min-h-screen max-w-md items-center px-6 py-12",children:s.jsxs(o.div,{className:"w-full space-y-6",...t(0),children:[s.jsxs(o.div,{className:"space-y-2 text-center",...t(.04),children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-muted-foreground",children:"Neturai IT Manager"}),s.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Verifying Reset Link"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we verify your reset link."})]}),s.jsx(o.div,{...t(.08),children:s.jsxs(x,{className:"border-muted/60 shadow-sm",children:[s.jsxs(u,{children:[s.jsx(p,{className:"text-lg",children:"Verifying Token"}),s.jsx(h,{children:"This should only take a moment."})]}),s.jsxs(f,{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"If you are not redirected, request a new reset link."}),s.jsx("div",{className:"mt-4 text-center text-sm",children:s.jsx(T,{to:"/forgot-password",className:"underline",children:"Go to Forgot Password"})})]})]})})]})})})};export{O as default};
